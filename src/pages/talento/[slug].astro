---
import { socios } from '../../data/socios.js';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  return [
    { params: { slug: 'fauer' } },
    { params: { slug: 'manuel' } },
  ];
}

const { slug } = Astro.params;
const socio = socios[slug];

if (!socio) {
  return new Response(null, {
    status: 404,
    statusText: 'Not found'
  });
}

const whatsappPhone = socio.contacto.telefono.replace(/\+/g, '').replace(/\s/g, '');
---

<Layout title={`${socio.nombre} | Bahos & Burbano`}>
  <main class="bg-white pt-16 pb-24 md:pt-24 md:pb-32" role="main">
    <div class="max-w-[1440px] mx-auto px-6 md:px-12 lg:px-24">
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-y-12 lg:gap-x-20 items-start">
        
        <div class="lg:col-span-4 bg-white pt-0 px-8 pb-8 md:px-10 md:pb-10 fade-in">
          <figure class="aspect-[3/4] w-full bg-[#F4F4F4] overflow-hidden grayscale contrast-[1.05] mb-8">
            <img
              src={socio.imagen}
              width="600"
              height="800"
              alt={`Retrato profesional de ${socio.nombre}, ${socio.cargo} en la firma`}
              class="w-full h-full object-cover"
              loading="eager"
              fetchpriority="high"
              decoding="async"
            />
            <figcaption class="sr-only">Socio {socio.nombre}</figcaption>
          </figure>

          <div class="flex flex-col gap-5 mb-6">
            <h1 class="font-['ClashDisplay'] text-[28px] md:text-[33px] font-bold text-[var(--color-bosque)] leading-tight tracking-[0.02em]">
              {socio.nombre}
            </h1>
            <span class="font-['Hanken_Grotesk'] text-[12px] tracking-[0.4em] uppercase font-bold text-brand-gold-champagne/90 antialiased">
              {socio.cargo}
            </span>
          </div>

          <address class="flex flex-col gap-6 pt-6 not-italic">
            <div class="flex flex-col">
              <span class="text-[12px] font-bold tracking-[0.3em] text-brand-gold-champagne uppercase mb-1">Email</span>
              <a href={`mailto:${socio.contacto.email}`} class="hover:text-brand-gold-champagne transition-colors truncate block py-2">{socio.contacto.email}</a>
            </div>
            <div class="flex flex-col">
              <span class="text-[12px] font-bold tracking-[0.3em] text-brand-gold-champagne uppercase mb-1">WhatsApp</span>
              <a href={`https://wa.me/${whatsappPhone}?text=${encodeURIComponent(socio.contacto.whatsappMensaje + ' ' + socio.nombre)}`} target="_blank" rel="noopener" class="hover:text-brand-gold-champagne transition-colors font-medium py-1">
                <span>{socio.contacto.telefono}</span>
              </a>
            </div>
          </address>

          <a 
            href={socio.contacto.vcard} 
            download={`${socio.nombre}.vcf`}
            aria-label={`Descargar tarjeta de contacto de ${socio.nombre}`}
            class="group flex items-center gap-3 text-brand-green-mineral hover:text-brand-gold-champagne transition-all duration-500 mt-4 w-fit"
          >
            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 text-brand-gold-champagne">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
            </svg>
            <span class="font-bold tracking-[0.3em] text-[12px] uppercase">V-Card</span>
          </a>

          <div class="w-full h-[1px] bg-[var(--color-bosque)] opacity-10 my-10"></div>

          <nav aria-label="Navegación de retorno" class="mt-4">
            <a href="/talento#equipo" class="group flex flex-col items-start w-fit py-6 outline-none" aria-label="Regresar a Nuestro Equipo">
              <span class="font-['Hanken_Grotesk'] text-[12px] tracking-[0.5em] uppercase font-bold text-brand-gold-champagne mb-1">Volver</span>
              <span class="font-['ClashDisplay'] text-[16px] tracking-[0.05em] text-[var(--color-bosque)] font-medium mb-2">Nuestro Equipo</span>
              <div class="relative w-28 h-4 flex items-center overflow-visible">
                <svg 
                  viewBox="0 0 100 12" 
                  fill="none" 
                  xmlns="http://www.w3.org/2000/svg"
                  class="w-full h-full text-brand-gold-champagne transition-transform duration-700 ease-[cubic-bezier(0.19,1,0.22,1)] group-hover:-translate-x-3" 
                  aria-hidden="true"
                >
                  <path d="M98 6H2M2 6L14 1M2 6L14 11" stroke="currentColor" stroke-width="0.6" stroke-linecap="square" stroke-linejoin="miter"/>
                </svg>
              </div>
            </a>
          </nav>
        </div>

        <div class="lg:col-span-8 flex flex-col gap-16 md:gap-24 fade-in delay-200 lg:pl-12">
          
          <section aria-labelledby="perfil-heading">
            <h2 id="perfil-heading" class="flex items-center gap-6 font-['Hanken_Grotesk'] text-[14px] font-bold tracking-[0.3em] text-brand-gold-champagne uppercase mb-8">
              <span>Perfil</span><div class="stela-axial-sober"></div>
            </h2>
            <div class="flex flex-col gap-8">
              {socio.perfil.map((p, i) => <p key={i} class="font-['Hanken_Grotesk'] text-[16px] md:text-[17px] text-brand-green-mineral leading-relaxed max-w-[780px]">{p}</p>)}
            </div>
          </section>

          <section aria-labelledby="exp-heading">
            <h2 id="exp-heading" class="flex items-center gap-6 font-['Hanken_Grotesk'] text-[14px] font-bold tracking-[0.3em] text-brand-gold-champagne uppercase mb-8">
              <span>Experiencia</span><div class="stela-axial-sober"></div>
            </h2>
            <div class="flex flex-col gap-8">
              {socio.experiencia.map((p, i) => <p key={i} class="font-['Hanken_Grotesk'] text-[16px] md:text-[17px] text-brand-green-mineral leading-relaxed max-w-[780px]">{p}</p>)}
            </div>
          </section>

          <section aria-labelledby="acad-heading">
            <h2 id="acad-heading" class="flex items-center gap-6 font-['Hanken_Grotesk'] text-[14px] font-bold tracking-[0.3em] text-brand-gold-champagne uppercase mb-8">
              <span>Trayectoria Académica</span><div class="stela-axial-sober"></div>
            </h2>
            <div class="flex flex-col gap-8">
              {socio.academia.map((item, i) => (
                <div key={i} class="flex flex-col gap-2">
                  <span class="font-['Hanken_Grotesk'] text-[16px] md:text-[17px] font-bold text-brand-green-mineral leading-none">{item.grado}</span>
                  <span class="font-['Hanken_Grotesk'] text-[16px] text-brand-green-mineral italic">{item.institucion}</span>
                </div>
              ))}
            </div>
          </section>

         <section aria-labelledby="pract-heading">
            <h2 id="pract-heading" class="flex items-center gap-6 font-['Hanken_Grotesk'] text-[14px] font-bold tracking-[0.3em] text-brand-gold-champagne uppercase mb-8">
              <span>Áreas de Práctica</span><div class="stela-axial-sober"></div>
            </h2>
            <ul class="flex flex-col w-full">
              {socio.expertise.map((item, i) => (
                <li key={i} class="border-b border-[var(--color-bosque)]/5 last:border-0 group/item">
                  
                  {/* AQUÍ ESTÁ LA CORRECCIÓN CLAVE: Usamos item.link e item.titulo */}
                  <a 
                    href={item.link}
                    class="block py-3 font-['Hanken_Grotesk'] text-[16px] md:text-[17px] text-brand-green-mineral group-hover/item:text-brand-gold-champagne transition-colors duration-300 antialiased"
                  >
                    {/* Verificamos si item.titulo (EL TEXTO) tiene el ampersand */}
                    {item.titulo.includes('&') ? item.titulo.split('&').map((chunk, j, arr) => (
                      <span key={j}>
                        {chunk}
                        {j < arr.length - 1 && (
                          <span aria-hidden="true" style="font-family: 'B612 Mono', monospace;" class="text-[19px] mx-1.5 relative top-[1px] opacity-90">&</span>
                        )}
                      </span>
                    )) : item.titulo}
                  </a>

                </li>
              ))}
            </ul>
          </section>
        </div>
      </div>
    </div>
  </main>
</Layout>

<style>
  /* 1. ANIMACIONES DE REVELADO (FADE-IN) */
  .fade-in {
    opacity: 0; 
    transform: translateY(10px);
    animation: fadeInLuxury 1.4s cubic-bezier(0.19, 1, 0.22, 1) forwards;
    will-change: transform, opacity;
  }
  .fade-in.delay-200 { animation-delay: 0.2s; }

  @keyframes fadeInLuxury {
    to { opacity: 1; transform: translateY(0); }
  }

  /* 2. ESTELA AXIAL (LÍNEA DORADA) */
  .stela-axial-sober {
    height: 1px;
    flex-grow: 1;
    background: linear-gradient(90deg, transparent 0%, rgba(184, 148, 79, 0.4) 50%, transparent 100%);
    opacity: 0;
    transform: scaleX(0);
    transform-origin: left;
    animation: growStela 2s cubic-bezier(0.19, 1, 0.22, 1) forwards;
    animation-delay: 0.8s;
    will-change: transform, opacity;
  }

  @keyframes growStela {
    to { opacity: 0.7; transform: scaleX(1); }
  }

  /* 3. HIGIENE Y ACCESIBILIDAD */
  a:focus-visible {
    outline: 2px solid var(--color-oro-noble);
    outline-offset: 4px;
    border-radius: 2px;
  }
  a { -webkit-tap-highlight-color: transparent; }

  @media (prefers-reduced-motion: reduce) {
    .fade-in, .stela-axial-sober {
      animation: none;
      transform: none;
      opacity: 1;
    }
  }
</style>