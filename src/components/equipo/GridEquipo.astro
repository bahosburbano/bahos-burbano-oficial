---
/* src/components/equipo/GridEquipo.astro - Calibración: Seda & Consistencia */

// 1. Traemos el "Cerebro" (Asegúrate de que la ruta sea correcta)
import { socios } from '../../data/socios.js';

// 2. Adaptador: Convertimos el Objeto en Lista y ajustamos los nombres (imagen -> foto)
const listaSocios = Object.keys(socios).map((key) => {
  const s = socios[key];
  return {
    nombre: s.nombre,
    cargo: s.cargo,
    // Tomamos los primeros dos expertise para la especialidad
    especialidad: s.expertise.slice(0, 2).join(" & "),
    slug: key,
    foto: s.imagen 
  };
});

// 3. Procesamos para el diseño de "especialidadPartes" que ya tenías
const sociosProcesados = listaSocios.map((s) => ({
  ...s,
  especialidadPartes: s.especialidad.split(" & "),
}));
---

<section 
  id="equipo" 
  class="relative bg-white pt-20 pb-32 md:pt-28 md:pb-48 overflow-hidden scroll-mt-24"
>
  <div class="max-w-[1440px] mx-auto px-6 md:px-28 relative">
    
    <div class="flex flex-col items-center">
      
      <div class="w-full md:w-auto flex justify-start md:absolute md:left-28 md:top-0 z-20 mb-16 md:mb-0">
        <div class="flex flex-row md:flex-col items-center gap-6 observer-element-equipo opacity-0">
          <span class="label-vertical-style">
            Nuestro Equipo
          </span>
          <div class="h-[1px] w-12 md:w-[1px] md:h-24 bg-[var(--color-oro-noble)] opacity-30"></div>
        </div>
      </div>

      <div class="w-full flex justify-center items-center">
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-16 md:gap-24 w-full max-w-[850px] justify-items-center">
          {sociosProcesados.map((socio, i) => (
            <a 
              href={`/talento/${socio.slug}`} 
              class="group flex flex-col items-center text-center observer-element-equipo no-underline outline-none opacity-0" 
              style={`transition-delay: ${0.3 + i * 0.2}s`}
              aria-label={`Ver perfil de ${socio.nombre}`}
            >
              
              <div class="w-[210px] md:w-[230px] aspect-[3/4] bg-[#F8F8F8] overflow-hidden grayscale group-hover:grayscale-0 transition-all duration-1000 relative border border-[var(--color-bosque)]/5">
                <img
                  src={socio.foto}
                  alt={socio.nombre}
                  class="w-full h-full object-cover transition-transform duration-[2.5s] ease-out group-hover:scale-105 antialiased"
                  loading="eager"
                  decoding="async"
                />
              </div>

              <div class="mt-8 flex flex-col items-center gap-3 w-full">
                <h3 class="font-['ClashDisplay'] font-semibold tracking-[0.12em] text-[20px] md:text-[22px] text-[var(--color-bosque)] leading-none antialiased">
                  {socio.nombre}
                </h3>

                <span class="font-sans text-[9px] tracking-[0.4em] uppercase font-bold text-[var(--color-bosque)] opacity-60">
                  {socio.cargo}
                </span>

                <div class="h-[1px] w-6 bg-[var(--color-oro-noble)] opacity-40 my-1 transition-all duration-700 ease-in-out group-hover:w-[210px] md:group-hover:w-[230px]"></div>

                <p class="font-['ClashDisplay'] text-[15px] text-[var(--color-bosque)] leading-relaxed max-w-[280px] mx-auto antialiased">
                  {socio.especialidadPartes[0]} {socio.especialidadPartes[1] && <span class="font-b612 text-[var(--color-bosque)] text-[14px]">&</span>}
                  {socio.especialidadPartes[1] && (
                    <span class="block mt-1">
                      {socio.especialidadPartes[1]}
                    </span>
                  )}
                </p>
              </div>
            </a>
          ))}
        </div>
      </div>
    </div>

  </div>
</section>

<script is:inline>
  {
    const options = { threshold: 0.15, rootMargin: "0px 0px -50px 0px" };
    const observerEqui = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          observerEqui.unobserve(entry.target);
        }
      });
    }, options);

    document.querySelectorAll('.observer-element-equipo').forEach(el => observerEqui.observe(el));
  }
</script>

<style is:global>
  .label-vertical-style {
    font-family: 'ClashDisplay', sans-serif;
    color: var(--color-oro-tecnico);
    font-size: 14px;
    letter-spacing: 0.8em;
    text-transform: uppercase;
    font-weight: 400;
    white-space: nowrap;
    writing-mode: horizontal-tb;
  }

  .font-b612 {
    font-family: 'B612 Mono', monospace !important;
  }

  @media (min-width: 768px) {
    .label-vertical-style {
      writing-mode: vertical-rl;
      transform: rotate(180deg);
    }
  }

  /* EFECTO SEDA: 40px Glide + 1.8s (Consistencia Sistémica) */
  .observer-element-equipo {
    opacity: 0;
    transform: translate3d(0, 40px, 0);
    transition: opacity 1.8s cubic-bezier(0.16, 1, 0.3, 1), 
                transform 1.8s cubic-bezier(0.16, 1, 0.3, 1);
    will-change: transform, opacity;
  }

  .observer-element-equipo.is-visible {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }

  .group:focus-visible {
    outline: 2px solid var(--color-oro-noble);
    outline-offset: 8px;
  }
</style>